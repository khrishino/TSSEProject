<?xml version="1.0"?>
<rdf:RDF
    xmlns:fn="http://www.w3.org/2005/xpath-functions#"
    xmlns="http://mivia.unisa.it/videotracking/rules.rdf#"
    xmlns:spinx="http://spinrdf.org/spinx#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:spin="http://spinrdf.org/spin#"
    xmlns:afn="http://jena.hpl.hp.com/ARQ/function#"
    xmlns:foaf="http://xmlns.com/foaf/0.1/"
    xmlns:sp="http://spinrdf.org/sp#"
    xmlns:tracking="http://mivia.unisa.it/videotracking/tracking.owl#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:spif="http://spinrdf.org/spif#"
    xmlns:arg="http://spinrdf.org/arg#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:list="http://jena.hpl.hp.com/ARQ/list#"
    xmlns:spl="http://spinrdf.org/spl#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xml:base="http://mivia.unisa.it/videotracking/rules.rdf">
  <owl:Ontology rdf:about="">
    <owl:versionInfo rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >owl:Ontology added by TopBraid</owl:versionInfo>
    <spin:imports rdf:resource="http://topbraid.org/spin/owlrl-all"/>
    <owl:imports rdf:resource="http://spinrdf.org/spinx"/>
    <owl:imports rdf:resource="http://spinrdf.org/spin"/>
    <owl:imports rdf:resource="http://www.w3.org/2002/07/owl"/>
  </owl:Ontology>
  <owl:Ontology rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#"/>
  <owl:Class rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#SpatialThing"/>
  <owl:Class rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#Frame">
    <spin:initializationRule>
      <sp:Modify>
        <sp:insertPattern rdf:parseType="Collection">
          <rdf:Description>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate>
              <owl:ObjectProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#hasNext"/>
            </sp:predicate>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >next</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >next</sp:varName>
            </sp:subject>
            <sp:object rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate>
              <owl:ObjectProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#hasPrevious"/>
            </sp:predicate>
          </rdf:Description>
        </sp:insertPattern>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Frame"/>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >next</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Frame"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate>
              <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#id"/>
            </sp:predicate>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >next</sp:varName>
            </sp:subject>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#id"/>
          </rdf:Description>
          <sp:Filter>
            <sp:expression>
              <sp:and>
                <sp:arg1>
                  <sp:and>
                    <sp:arg1>
                      <sp:eq>
                        <sp:arg2>
                          <sp:sub>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                            <sp:arg2 rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
                            >7</sp:arg2>
                          </sp:sub>
                        </sp:arg2>
                        <sp:arg1>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >x</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg1>
                      </sp:eq>
                    </sp:arg1>
                    <sp:arg2>
                      <sp:ne>
                        <sp:arg2>
                          <tracking:Frame rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#CurrentFrame">
                            <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                            >the id of the currentframe keeps track of what frame to examine</rdfs:comment>
                            <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                            >Current Frame</rdfs:label>
                          </tracking:Frame>
                        </sp:arg2>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >next</sp:varName>
                        </sp:arg1>
                      </sp:ne>
                    </sp:arg2>
                  </sp:and>
                </sp:arg1>
                <sp:arg2>
                  <sp:ne>
                    <sp:arg2 rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#CurrentFrame"/>
                    <sp:arg1 rdf:resource="http://spinrdf.org/spin#_this"/>
                  </sp:ne>
                </sp:arg2>
              </sp:and>
            </sp:expression>
          </sp:Filter>
          <sp:Filter>
            <sp:expression>
              <sp:notExists>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasNext"/>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >a</sp:varName>
                    </sp:object>
                    <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
                  </rdf:Description>
                </sp:elements>
              </sp:notExists>
            </sp:expression>
          </sp:Filter>
        </sp:where>
      </sp:Modify>
    </spin:initializationRule>
    <spin:sceneAnalysisRule>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >DELETE&#xD;
{&#xD;
&#xD;
?blob tracking:belongTo ?this .&#xD;
}&#xD;
INSERT&#xD;
{&#xD;
?union a tracking:Blob .&#xD;
?union tracking:belongTo ?this .&#xD;
?unionbb a tracking:BoundingBox .&#xD;
?union tracking:hasBoundingBox ?unionbb .&#xD;
?unionbb tracking:topLeftVertex ?uniontl .&#xD;
?unionbb tracking:topRightVertex ?uniontr .&#xD;
?unionbb tracking:bottomLeftVertex ?unionbl .&#xD;
?unionbb tracking:bottomRightVertex ?unionbr .&#xD;
?uniontl tracking:x ?mx1 .&#xD;
?uniontl tracking:y ?my1 .&#xD;
?unionbr tracking:x ?mx2 .&#xD;
?unionbr tracking:y ?my2 .&#xD;
?unionbl tracking:x ?mx1 .&#xD;
?unionbl tracking:y ?my2 .&#xD;
?uniontr tracking:x ?mx2 .&#xD;
?uniontr tracking:y ?my1 .&#xD;
}&#xD;
WHERE&#xD;
{&#xD;
#?this tracking:id ?id .&#xD;
#tracking:CurrentFrame tracking:id ?id .&#xD;
?blob tracking:belongTo ?this .&#xD;
(?this) spin:mergeFrameBlobs(?mx1  ?my1 ?mx2 ?my2 ) .&#xD;
BIND (URI(fn:concat(?this, "_union")) AS ?union) .&#xD;
BIND (URI(fn:concat(?this, "_unionbb")) AS ?unionbb) .&#xD;
BIND (URI(fn:concat(?this, "_union_topLeft")) AS ?uniontl) .&#xD;
BIND (URI(fn:concat(?this, "_union_topRight")) AS ?uniontr) .&#xD;
BIND (URI(fn:concat(?this, "_union_bottomLeft")) AS ?unionbl) .&#xD;
BIND (URI(fn:concat(?this, "_union_bottomRight")) AS ?unionbr) .&#xD;
FILTER (spin:closeToOccludingObject(?blob)) .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:sceneAnalysisRule>
    <spin:initializationRule>
      <sp:Modify>
        <sp:insertPattern rdf:parseType="Collection">
          <rdf:Description>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasPrevious"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >prev</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >prev</sp:varName>
            </sp:subject>
            <sp:object rdf:resource="http://spinrdf.org/spin#_this"/>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasNext"/>
          </rdf:Description>
        </sp:insertPattern>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Frame"/>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >prev</sp:varName>
            </sp:subject>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Frame"/>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#id"/>
            <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >prev</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#id"/>
          </rdf:Description>
          <sp:Filter>
            <sp:expression>
              <sp:and>
                <sp:arg1>
                  <sp:and>
                    <sp:arg2>
                      <sp:ne>
                        <sp:arg2 rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#CurrentFrame"/>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >prev</sp:varName>
                        </sp:arg1>
                      </sp:ne>
                    </sp:arg2>
                    <sp:arg1>
                      <sp:eq>
                        <sp:arg1>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >x</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg1>
                        <sp:arg2>
                          <sp:add>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                            <sp:arg2 rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
                            >7</sp:arg2>
                          </sp:add>
                        </sp:arg2>
                      </sp:eq>
                    </sp:arg1>
                  </sp:and>
                </sp:arg1>
                <sp:arg2>
                  <sp:ne>
                    <sp:arg2 rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#CurrentFrame"/>
                    <sp:arg1 rdf:resource="http://spinrdf.org/spin#_this"/>
                  </sp:ne>
                </sp:arg2>
              </sp:and>
            </sp:expression>
          </sp:Filter>
          <sp:Filter>
            <sp:expression>
              <sp:notExists>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <sp:subject rdf:resource="http://spinrdf.org/spin#_this"/>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >a</sp:varName>
                    </sp:object>
                    <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasPrevious"/>
                  </rdf:Description>
                </sp:elements>
              </sp:notExists>
            </sp:expression>
          </sp:Filter>
        </sp:where>
      </sp:Modify>
    </spin:initializationRule>
  </owl:Class>
  <owl:Class rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#Blob">
    <spin:lastFrameAdvance>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >DELETE {
    tracking:CurrentFrame tracking:id ?curID
}&#xD;
INSERT{&#xD;
tracking:CurrentFrame tracking:id ?nextID&#xD;
}
WHERE {
    tracking:CurrentFrame tracking:id ?curID .&#xD;
?frame tracking:id ?curID .&#xD;
?frame tracking:hasNext ?nextFrame .&#xD;
?nextFrame tracking:id ?nextID .
}</sp:text>
      </sp:Modify>
    </spin:lastFrameAdvance>
    <spin:rule_2Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >#this rules adds people that have disappeared to groups&#xD;
INSERT {&#xD;
  ?group foaf:member ?trackedItem .&#xD;
?trackedItem tracking:hasSituation tracking:JoinAGroup&#xD;
}&#xD;
WHERE {&#xD;
#groups in current frame &#xD;
?group a foaf:Group .&#xD;
?group tracking:blobMatch ?this .&#xD;
?this tracking:belongTo ?frame.&#xD;
#?frame tracking:id ?id.&#xD;
# tracking:CurrentFrame tracking:id ?id.    &#xD;
?group tracking:hasBoundingBox ?bb .&#xD;
?this tracking:hasBoundingBox ?bb .&#xD;
?bb tracking:bottomLeftVertex ?point .&#xD;
?point tracking:x ?x1 .&#xD;
?point tracking:y ?y1 .&#xD;
#tracked items with no matches in previous frame&#xD;
?trackedItem tracking:hasDirection ?dir .&#xD;
?trackedItem tracking:hasBoundingBox ?bb2 .&#xD;
 ?trackedItem tracking:blobMatch ?b2 .&#xD;
?b2 tracking:hasBoundingBox ?bb2 .&#xD;
?b2 tracking:belongTo ?frame2 .&#xD;
?frame2 tracking:hasNext ?frame .&#xD;
#compute predictedPosition of tracked item&#xD;
?trackedItem spin:predictPosition(?x2 ?y2)&#xD;
#compute distance between group and predicted position&#xD;
 BIND (afn:sqrt((((xsd:integer(?x1) - xsd:float(?x2)) * (xsd:integer(?x1) - xsd:float(?x2))) + ((xsd:integer(?y1) - xsd:float(?y2)) * (xsd:integer(?y1) - xsd:float(?y2))))) AS ?dist) .&#xD;
FILTER(?dist&lt;70)&#xD;
FILTER NOT EXISTS { &#xD;
        ?trackedItem tracking:hasSituation tracking:JoinAGroup .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_2Executed>
    <spin:rule_3Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {&#xD;
    ?person a foaf:Person .&#xD;
    ?person tracking:blobMatch ?this .&#xD;
    ?person tracking:firstSeenAt ?frame .&#xD;
    ?person tracking:hasBoundingBox ?bb .&#xD;
  &#xD;
    ?person tracking:hasAverageSpeed 0 .&#xD;
}&#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
    ?this tracking:height ?h .&#xD;
    ?this tracking:width ?w .&#xD;
   ?this tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
 &#xD;
    BIND (URI(fn:concat(?this, "_person") ) AS ?person) .&#xD;
   &#xD;
    FILTER (spin:hasHumanSize(?this)) .&#xD;
    FILTER NOT EXISTS {&#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_3Executed>
    <spin:rule_1Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >DELETE {&#xD;
    ?previousGroup tracking:hasBoundingBox ?a .&#xD;
    ?previousGroup tracking:hasDirection ?d .&#xD;
    ?previousGroup tracking:hasAverageSpeed ?s .&#xD;
}&#xD;
INSERT {&#xD;
    ?previousGroup tracking:blobMatch ?this .&#xD;
    ?previousGroup tracking:hasBoundingBox ?bb .&#xD;
    ?previousPerson tracking:hasDirection ?newDir .&#xD;
    ?previousGroup tracking:hasAverageSpeed ?newSpeed .&#xD;
} &#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
    ?previousGroup a foaf:Group .&#xD;
    ?previousGroup tracking:blobMatch ?b2 .&#xD;
?b2 tracking:belongTo ?frame1 .&#xD;
?this tracking:belongTo ?frame2 .&#xD;
?frame1 tracking:hasNext ?frame2 .&#xD;
?frame2 tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
    OPTIONAL {&#xD;
        ?previousGroup tracking:hasBoundingBox ?a .&#xD;
}&#xD;
   OPTIONAL {     &#xD;
?previousGroup tracking:hasDirection ?d .&#xD;
}&#xD;
   OPTIONAL {     &#xD;
?previousGroup tracking:hasAverageSpeed ?s .&#xD;
    } .&#xD;
    BIND (spin:getBlobSpeed(?b2, ?this) AS ?newSpeed) .&#xD;
    BIND (tracking:blobDistance(?b2, ?this) AS ?dist) .&#xD;
    BIND (URI(tracking:getNewDirection(?b2, ?this) ) AS ?newDir) .&#xD;
    FILTER (( (?dist &lt;= 70)) &amp;&amp; spin:hasGroupSize(?this)) .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_1Executed>
    <spin:rule_1Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >DELETE {&#xD;
    ?previousPerson tracking:hasBoundingBox ?a .&#xD;
    ?previousPerson tracking:hasDirection ?d .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
}&#xD;
INSERT {&#xD;
    ?previousPerson tracking:blobMatch ?this .&#xD;
    ?previousPerson tracking:hasBoundingBox ?bb .&#xD;
    ?previousPerson tracking:hasDirection ?newDir .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?newSpeed .&#xD;
}&#xD;
WHERE {&#xD;
    ?previousPerson a foaf:Person .&#xD;
    ?previousPerson tracking:blobMatch ?b2 .&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
?b2 tracking:belongTo ?frame1 .&#xD;
?this tracking:belongTo ?frame2.&#xD;
?frame2 tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
?frame1 tracking:hasNext ?frame2 .&#xD;
&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasBoundingBox ?a .&#xD;
    } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasDirection ?d .&#xD;
    } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
    } .&#xD;
    BIND (spin:getBlobSpeed(?b2, ?this) AS ?newSpeed) .&#xD;
    BIND (URI(tracking:getNewDirection(?b2,?this)) AS ?newDir) .&#xD;
    BIND (tracking:blobDistance(?b2, ?this) AS ?dist) .&#xD;
    FILTER ((( spin:hasHumanSize(?this)) &amp;&amp; (?dist &lt;= 70)) &amp;&amp; (?dist = spin:getMinHumanDistance(?b2))) .&#xD;
    FILTER NOT EXISTS { &#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
FILTER NOT EXISTS { &#xD;
        ?previousPerson tracking:hasSituation tracking:JoinAGroup .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_1Executed>
    <spin:rule_2Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >#predicts position of people in groups and assigns blobs according to it&#xD;
DELETE {&#xD;
?previousPerson tracking:hasSituation tracking:JoinAGroup .&#xD;
    ?previousPerson tracking:hasBoundingBox ?a .&#xD;
    ?previousPerson tracking:hasDirection ?d .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
}&#xD;
INSERT {&#xD;
?previousPerson tracking:hasSituation tracking:LeavingAGroup .&#xD;
    ?previousPerson tracking:blobMatch ?this .&#xD;
    ?previousPerson tracking:hasBoundingBox ?bb .&#xD;
    ?previousPerson tracking:hasDirection ?newDir .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?newSpeed .&#xD;
}&#xD;
WHERE {&#xD;
#person currently in a group&#xD;
?previousPerson a foaf:Person .&#xD;
?previousPerson tracking:hasSituation tracking:JoinAGroup .&#xD;
?group foaf:member ?previousPerson .&#xD;
?group tracking:blobMatch ?b2 .&#xD;
#group is in previous frame&#xD;
#?b2 tracking:hasBoundingBox ?groupbb .&#xD;
#?group tracking:hasBoundingBox ?groupbb .&#xD;
?b2 tracking:belongTo ?frame1 .&#xD;
?this tracking:belongTo ?frame2.&#xD;
?frame2 tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
?frame1 tracking:hasNext ?frame2 .&#xD;
#predict person position based on last seen speed and direction&#xD;
?previousPerson spin:predictPositionInGroups (?x2 ?y2) .&#xD;
?this tracking:hasBoundingBox ?bb .&#xD;
?bb tracking:bottomLeftVertex ?point .&#xD;
?point tracking:x ?x1 .&#xD;
?point tracking:y ?y1 .&#xD;
BIND (afn:sqrt((((xsd:integer(?x1) - xsd:float(?x2)) * (xsd:integer(?x1) - xsd:float(?x2))) + ((xsd:integer(?y1) - xsd:float(?y2)) * (xsd:integer(?y1) - xsd:float(?y2))))) AS ?dist) .&#xD;
#data to delete&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasBoundingBox ?a .&#xD;
   } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasDirection ?d .&#xD;
    } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
    } .&#xD;
#compute new speed, direction and bounding box&#xD;
    BIND (spin:getBlobSpeed(?b2, ?this) AS ?newSpeed) .&#xD;
    BIND (URI(tracking:getNewDirection(?b2,?this)) AS ?newDir) .&#xD;
&#xD;
    FILTER ( spin:hasHumanSize(?this)&amp;&amp;?dist&lt;30) .&#xD;
 FILTER NOT EXISTS {&#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
FILTER NOT EXISTS {&#xD;
   ?previousPerson tracking:blobMatch ?blob .&#xD;
?blob tracking:belongTo ?frame2.&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_2Executed>
    <rdfs:subClassOf rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#SpatialThing"/>
    <spin:rule_2Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {&#xD;
    ?person a foaf:Person .&#xD;
    ?person tracking:blobMatch ?this .&#xD;
    ?person tracking:firstSeenAt ?frame .&#xD;
    ?person tracking:hasBoundingBox ?bb .&#xD;
    ?person tracking:hasDirection ?dirURI .&#xD;
    ?person tracking:hasAverageSpeed 0 .&#xD;
?person tracking:hasDirection tracking:stop .&#xD;
}&#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
    ?this tracking:height ?h .&#xD;
    ?this tracking:width ?w .&#xD;
   ?this tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
    ?area a tracking:EntryArea .&#xD;
    BIND (URI(fn:concat(?this, "_person") ) AS ?person) .&#xD;
    OPTIONAL {&#xD;
        ?area tracking:defaultEntryDirection ?dir .&#xD;
        BIND (URI(?dir) AS ?dirURI) .&#xD;
    } .&#xD;
    FILTER (spin:hasHumanSize(?this) &amp;&amp; spin:feetInArea(?area, ?this)) .&#xD;
    FILTER NOT EXISTS {&#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_2Executed>
    <rdfs:comment xml:lang="en">A joint set of pixels detected by the low-level algorithm</rdfs:comment>
    <spin:rule_3Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {
    ?noise a tracking:Noise .
    ?noise tracking:blobMatch ?this .
}
WHERE {
    ?this tracking:hasBoundingBox ?bb .
    ?this tracking:height ?h .
    ?this tracking:width ?w .&#xD;
?this tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.
    BIND (URI(fn:concat(?this, "_noise")) AS ?noise) .
    FILTER ((!spin:hasHumanSize(?this)) &amp;&amp; (!spin:hasGroupSize(?this) )) .
    FILTER NOT EXISTS {
        ?p tracking:blobMatch ?this .
    } .
}</sp:text>
      </sp:Modify>
    </spin:rule_3Executed>
    <spin:rule_1Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >#predicts position of people in groups and assigns blobs according to it&#xD;
DELETE {&#xD;
?previousPerson tracking:hasSituation tracking:JoinAGroup .&#xD;
    ?previousPerson tracking:hasBoundingBox ?a .&#xD;
    ?previousPerson tracking:hasDirection ?d .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
}&#xD;
INSERT {&#xD;
?previousPerson tracking:hasSituation tracking:LeavingAGroup .&#xD;
    ?previousPerson tracking:blobMatch ?this .&#xD;
    ?previousPerson tracking:hasBoundingBox ?bb .&#xD;
    ?previousPerson tracking:hasDirection ?newDir .&#xD;
    ?previousPerson tracking:hasAverageSpeed ?newSpeed .&#xD;
}&#xD;
WHERE {&#xD;
#person currently in a group&#xD;
?previousPerson a foaf:Person .&#xD;
?previousPerson tracking:hasSituation tracking:JoinAGroup .&#xD;
?group foaf:member ?previousPerson .&#xD;
?group tracking:blobMatch ?b2 .&#xD;
#group is in previous frame&#xD;
#?b2 tracking:hasBoundingBox ?groupbb .&#xD;
#?group tracking:hasBoundingBox ?groupbb .&#xD;
?b2 tracking:belongTo ?frame1 .&#xD;
?this tracking:belongTo ?frame2.&#xD;
?frame2 tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
?frame1 tracking:hasNext ?frame2 .&#xD;
#predict person position based on last seen speed and direction&#xD;
?previousPerson spin:predictPositionInGroups (?x2 ?y2) .&#xD;
?this tracking:hasBoundingBox ?bb .&#xD;
?bb tracking:bottomLeftVertex ?point .&#xD;
?point tracking:x ?x1 .&#xD;
?point tracking:y ?y1 .&#xD;
BIND (afn:sqrt((((xsd:integer(?x1) - xsd:float(?x2)) * (xsd:integer(?x1) - xsd:float(?x2))) + ((xsd:integer(?y1) - xsd:float(?y2)) * (xsd:integer(?y1) - xsd:float(?y2))))) AS ?dist) .&#xD;
#data to delete&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasBoundingBox ?a .&#xD;
   } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasDirection ?d .&#xD;
    } .&#xD;
    OPTIONAL {&#xD;
        ?previousPerson tracking:hasAverageSpeed ?s .&#xD;
    } .&#xD;
#compute new speed, direction and bounding box&#xD;
    BIND (spin:getBlobSpeed(?b2, ?this) AS ?newSpeed) .&#xD;
    BIND (URI(tracking:getNewDirection(?b2,?this)) AS ?newDir) .&#xD;
&#xD;
    FILTER ( spin:hasHumanSize(?this)&amp;&amp;?dist&lt;30) .&#xD;
 FILTER NOT EXISTS {&#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
FILTER NOT EXISTS {&#xD;
   ?previousPerson tracking:blobMatch ?blob .&#xD;
?blob tracking:belongTo ?frame2.&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_1Executed>
    <spin:rule_3Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >DELETE&#xD;
{&#xD;
?person1 tracking:blobMatch ?this .&#xD;
?person2 tracking:blobMatch ?this&#xD;
}&#xD;
INSERT {&#xD;
    ?group a foaf:Group .&#xD;
    ?group tracking:blobMatch ?this .  &#xD;
    ?group tracking:hasBoundingBox ?bb .&#xD;
  ?group tracking:hasAverageSpeed 0 .&#xD;
?group tracking:hasDirection tracking:stop .&#xD;
?group foaf:member ?person1 .&#xD;
?group foaf:member ?person2 .&#xD;
?person1 tracking:hasSituation tracking:JoinAGroup .&#xD;
?person2 tracking:hasSituation tracking:JoinAGroup&#xD;
}&#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
   ?this tracking:height ?h .&#xD;
    ?this tracking:width ?w .&#xD;
 ?this tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.&#xD;
?person1 a foaf:Person .&#xD;
?person2 a foaf:Person .&#xD;
?person1 tracking:blobMatch ?this .&#xD;
?person2 tracking:blobMatch ?this&#xD;
   BIND (URI(fn:concat(?person1, "_group") ) AS ?group) .&#xD;
    FILTER( (?person1!=?person2)&amp;&amp; (xsd:string(?person1)&lt;xsd:string(?person2))) .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_3Executed>
    <spin:rule_2Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {&#xD;
    ?group a foaf:Group .&#xD;
    ?group tracking:blobMatch ?this .&#xD;
    ?group tracking:firstSeenAt ?frame .&#xD;
 ?group tracking:hasBoundingBox ?bb .&#xD;
    ?group tracking:hasAverageSpeed 0 .&#xD;
?group tracking:hasDirection tracking:stop .&#xD;
}&#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
    ?this tracking:height ?h .&#xD;
    ?this tracking:width ?w .&#xD;
    ?this tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
 tracking:CurrentFrame tracking:id ?id.    &#xD;
    BIND (URI(fn:concat(?this, "_group")) AS ?group) .&#xD;
    FILTER (spin:hasGroupSize(?this)  ) .&#xD;
  FILTER NOT EXISTS {&#xD;
        ?p tracking:blobMatch ?this .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_2Executed>
    <spin:initializationRule>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {&#xD;
    ?this tracking:height ?h .&#xD;
    ?this tracking:width ?w .&#xD;
} &#xD;
WHERE {&#xD;
    ?this tracking:hasBoundingBox ?bb1 .&#xD;
    ?bb1 tracking:bottomRightVertex ?point1 .&#xD;
    ?bb1 tracking:topLeftVertex ?point2 .&#xD;
    ?point1 tracking:y ?y1 .&#xD;
    ?point2 tracking:y ?y2 .&#xD;
    ?point1 tracking:x ?x1 .&#xD;
    ?point2 tracking:x ?x2 .&#xD;
    BIND ((xsd:integer(?y1) - xsd:integer(?y2) ) AS ?h) .&#xD;
    BIND ((xsd:integer(?x1) - xsd:integer(?x2)) AS ?w) .&#xD;
    FILTER NOT EXISTS {&#xD;
        ?this tracking:height ?ha .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:initializationRule>
    <rdfs:subClassOf>
      <owl:Restriction>
        <owl:cardinality rdf:datatype="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"
        >1</owl:cardinality>
        <owl:onProperty rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#id"/>
      </owl:Restriction>
    </rdfs:subClassOf>
  </owl:Class>
  <owl:Class rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#SpatialPerspectiveArea">
    <spin:initializationRule>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >INSERT {&#xD;
    ?this tracking:maxHumanHeight ?hMaxF .&#xD;
    ?this tracking:minHumanHeight ?hMinF .&#xD;
    ?this tracking:maxHumanWidth ?wMaxF .&#xD;
    ?this tracking:minHumanWidth ?wMinF .&#xD;
}&#xD;
WHERE {&#xD;
    ?this tracking:hfactor ?hf .&#xD;
    ?this tracking:wfactor ?wf .&#xD;
    tracking:DefaultPerspectiveArea tracking:maxHumanHeight ?hMax .&#xD;
    tracking:DefaultPerspectiveArea tracking:minHumanHeight ?hMin .&#xD;
    tracking:DefaultPerspectiveArea tracking:maxHumanWidth ?wMax .&#xD;
    tracking:DefaultPerspectiveArea tracking:minHumanWidth ?wMin .&#xD;
    BIND ((xsd:integer(?hMax) / xsd:float(?hf)) AS ?hMaxF) .&#xD;
    BIND ((xsd:integer(?hMin) / xsd:float(?hf)) AS ?hMinF) .&#xD;
    BIND ((xsd:integer(?wMax) / xsd:float(?wf)) AS ?wMaxF) .&#xD;
    BIND ((xsd:integer(?wMin) / xsd:float(?wf)) AS ?wMinF) .&#xD;
    FILTER NOT EXISTS {&#xD;
        ?this tracking:maxHumanHeight ?a .&#xD;
        ?this tracking:minHumanHeight ?b .&#xD;
        ?this tracking:maxHumanWidth ?c .&#xD;
        ?this tracking:minHumanWidth ?d .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:initializationRule>
  </owl:Class>
  <owl:Class rdf:about="http://xmlns.com/foaf/0.1/Group"/>
  <owl:ObjectProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
  <owl:ObjectProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#blobMatch"/>
  <owl:ObjectProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#hasVertex"/>
  <rdf:Property rdf:about="http://spinrdf.org/arg#group">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#y2">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#x4">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#spThing2">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#ablob">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#spThing">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#ybb">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#frame">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/sp#arg7">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#x1">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/sp#arg9">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#aPerson">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#x3">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#y1">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#yp">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#xbb">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#area">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#bb">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#spThing1">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#aGroup">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#xp">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#itemType">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#x2">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/sp#arg6">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#min_pix">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#num_pix">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/sp#arg8">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <rdf:Property rdf:about="http://spinrdf.org/arg#actual_dir">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#hfactor"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#realWidth"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#realHeight"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#width"/>
  <owl:DatatypeProperty rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#height"/>
  <owl:NamedIndividual rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#Big_Perspective"/>
  <spin:MagicProperty rdf:about="http://spinrdf.org/spin#predictPositionInGroups">
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?newX ?newY&#xD;
        WHERE {&#xD;
?group foaf:member ?arg1 .&#xD;
            ?group tracking:hasBoundingBox ?bb .&#xD;
?blob tracking:hasBoundingBox ?bb .&#xD;
?blob tracking:belongTo ?frame .&#xD;
?frame tracking:hasNext ?next .&#xD;
?frame tracking:id ?id.&#xD;
?next tracking:id ?nextID .&#xD;
            ?bb tracking:bottomLeftVertex ?bl .&#xD;
            ?bl tracking:x ?x .&#xD;
            ?bl tracking:y ?y .&#xD;
#position according to last seen speed and direction&#xD;
            ?arg1 tracking:hasAverageSpeed ?speed .&#xD;
            ?arg1 tracking:hasDirection ?dir .&#xD;
LET( ?time :=(xsd:integer(?nextID)-xsd:integer(?id))/7).&#xD;
            BIND (spin:predictXPosition(?x, ?dir, ?speed, ?time) AS ?newX) .&#xD;
            BIND (spin:predictYPosition(?y, ?dir, ?speed, ?time) AS ?newY) .&#xD;
}</sp:text>
      </sp:Select>
    </spin:body>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#MagicProperties"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >predicts the future position of a person in a group</rdfs:comment>
  </spin:MagicProperty>
  <spin:Function rdf:about="http://spinrdf.org/spin#checkBoxClosenessToAO">
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of the bottom right vertex of BB - bry</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >var bbxmin = arg1;&#xD;
var bbxmax = arg3;&#xD;
var bbymin = arg2;&#xD;
var bbymax = arg4;&#xD;
var oaxmin = arg5;&#xD;
var oaxmax = arg7;&#xD;
var oaymin = arg6;&#xD;
var oaymax = arg8;&#xD;
var diffx = (arg5 - arg1);&#xD;
var diffy = (arg6 - arg2);&#xD;
var ris=false;&#xD;
&#xD;
if (((diffx &gt;= 0) &amp;&amp; ((bbxmax+arg9) &gt;= oaxmin)) &amp;&amp; !((oaymin - bbymax)&gt;0 || (bbymin - oaymax)&gt;0))&#xD;
		ris=true;&#xD;
else if (((diffx &lt;=0) &amp;&amp; ((bbxmin-arg9) &lt; oaxmax)) &amp;&amp; !((oaymin - bbymax)&gt;0 || (bbymin - oaymax)&gt;0))&#xD;
		ris=true;&#xD;
return ris;&#xD;
</spinx:javaScriptCode>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of top left vertex of BB - tlx</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#boolean"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg7"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of the bottom right vertex of occlusion area - oabrx</rdfs:comment>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg5"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of the top left vertex of occlusion area - oatlx</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of top left vertex of BB - tly</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg8"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of the top left vertex of occlusion area - oabry</rdfs:comment>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg6"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of the top left vertex of occlusion area - oatly</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >minimum distance in pixel for considering closer the 2 BB</rdfs:comment>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg9"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of the bottom right vertex of BB - brx</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#closeToOArea">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#ablob"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >asks if a boundingbox is close to an occlusion area</rdfs:label>
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?ablob tracking:hasBoundingBox ?bb1 .
    ?Oarea a tracking:OArea .
    ?Oarea tracking:hasBoundingBox ?bbOarea .
    ?bb1 tracking:topLeftVertex ?tl .
    ?bb1 tracking:bottomRightVertex ?br .
    ?br tracking:x ?brx .
    ?br tracking:y ?bry .
    ?tl tracking:x ?tlx .
    ?tl tracking:y ?tly .
    ?bbOarea tracking:topLeftVertex ?bbOareaTL .
    ?bbOarea tracking:bottomRightVertex ?bbOareaBR .
    ?bbOareaTL tracking:x ?bbOareaTLx .
    ?bbOareaTL tracking:y ?bbOareaTLy .
    ?bbOareaBR tracking:x ?bbOareaBRx .
    ?bbOareaBR tracking:y ?bbOareaBRy .
    FILTER spin:checkBoxClosenessToAO( ?tlx, ?tly, ?brx, ?bry, ?bbOareaTLx, ?bbOareaTLy, ?bbOareaBRx, ?bbOareaBRy, 4) .
}</sp:text>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#hasOArea">
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >return if element has perspective area</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:body>
      <sp:Ask>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >area</sp:varName>
            </sp:subject>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#OArea"/>
          </rdf:Description>
          <sp:Filter>
            <sp:expression>
              <spin:contains>
                <arg:spThing1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >area</sp:varName>
                </arg:spThing1>
                <arg:spThing2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >spThing</sp:varName>
                </arg:spThing2>
              </spin:contains>
            </sp:expression>
          </sp:Filter>
        </sp:where>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#getAverageSpeed">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg5"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Get Average Speed</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Compute speed according to the movement average speed between two frames</rdfs:comment>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >/*&#xD;
arg1: p1.x&#xD;
arg2:p1.y&#xD;
arg3:p2.x&#xD;
arg4:p2.y&#xD;
arg5:frame1.id&#xD;
arg6:frame2.id&#xD;
*/&#xD;
//compute distance between points&#xD;
var dist=Math.sqrt(Math.pow(arg1-arg3,2)+Math.pow(arg2-arg4,2));&#xD;
//compute time . 1 sec=7 frames&#xD;
var time=(arg6-arg5)/7;&#xD;
//average speed=dist/time&#xD;
var avgSpeed=dist/time;&#xD;
return avgSpeed;</spinx:javaScriptCode>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg6"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#intersect">
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?bb1 tracking:hasCenter ?bb1Cpoint1 .
    ?bb2 tracking:hasCenter ?bb2Cpoint1 .
    ?spThing1 tracking:width ?w1 .
    ?spThing1 tracking:height ?h1 .
    ?spThing2 tracking:width ?w2 .
    ?spThing2 tracking:height ?h2 .
    ?bb1Cpoint1 tracking:x ?x1 .
    ?bb1Cpoint1 tracking:y ?y1 .
    ?bb2Cpoint1 tracking:x ?x2 .
    ?bb2Cpoint1 tracking:y ?y2 .
    FILTER spin:checkBoxIntersection( ?x1, ?y1, ?x2, ?y2, ?w1, ?h1, ?w2, ?h2) .
}</sp:text>
      </sp:Ask>
    </spin:body>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >asks if there is intersection between two resources</rdfs:label>
    <rdfs:subClassOf>
      <spin:Template rdf:about="http://spinrdf.org/spin#ResourceComparison">
        <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Templates"/>
        <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >template for resource comparison</rdfs:label>
        <spin:constraint>
          <spl:Argument>
            <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
            <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >First Spatial Thing</rdfs:comment>
            <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing1"/>
          </spl:Argument>
        </spin:constraint>
        <spin:constraint>
          <spl:Argument>
            <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >Secondo Spatial Thing</rdfs:comment>
            <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing2"/>
            <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
          </spl:Argument>
        </spin:constraint>
      </spin:Template>
    </rdfs:subClassOf>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#countMembersInGroup">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#group"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >count Members In Group</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >computes number of members in group</rdfs:comment>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >select count (?person)&#xD;
where&#xD;
{ &#xD;
?group foaf:member ?person .&#xD;
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <rdf:Description rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#rightentry">
    <tracking:width rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >68</tracking:width>
    <tracking:height rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >293</tracking:height>
  </rdf:Description>
  <spin:MagicProperty rdf:about="http://spinrdf.org/spin#predictPosition">
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?newX ?newY&#xD;
        WHERE {&#xD;
            ?arg1 tracking:hasBoundingBox ?bb .&#xD;
?blob tracking:hasBoundingBox ?bb .&#xD;
?blob tracking:belongTo ?frame .&#xD;
?frame tracking:hasNext ?next .&#xD;
?frame tracking:id ?id.&#xD;
?next tracking:id ?nextID .&#xD;
            ?bb tracking:bottomLeftVertex ?bl .&#xD;
            ?bl tracking:x ?x .&#xD;
            ?bl tracking:y ?y .&#xD;
            ?arg1 tracking:hasAverageSpeed ?speed .&#xD;
            ?arg1 tracking:hasDirection ?dir .&#xD;
LET( ?time :=(xsd:integer(?nextID)-xsd:integer(?id))/7).&#xD;
            BIND (spin:predictXPosition(?x, ?dir, ?speed, ?time) AS ?newX) .&#xD;
            BIND (spin:predictYPosition(?y, ?dir, ?speed, ?time) AS ?newY) .&#xD;
}</sp:text>
      </sp:Select>
    </spin:body>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >predicts the future position of an object</rdfs:comment>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#MagicProperties"/>
  </spin:MagicProperty>
  <spin:RuleProperty rdf:about="http://spinrdf.org/spin#initializationRule">
    <spin:rulePropertyMaxIterationCount rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >1</spin:rulePropertyMaxIterationCount>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Initialization Rule</rdfs:label>
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Performed at the start of the inference process and only once</rdfs:comment>
    <spin:nextRuleProperty>
      <spin:RuleProperty rdf:about="http://spinrdf.org/spin#rule_1Executed">
        <spin:rulePropertyMaxIterationCount rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
        >15</spin:rulePropertyMaxIterationCount>
        <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
        <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >Rules that are executed first</rdfs:label>
        <spin:nextRuleProperty>
          <spin:RuleProperty rdf:about="http://spinrdf.org/spin#rule_2Executed">
            <spin:rulePropertyMaxIterationCount rdf:datatype=
            "http://www.w3.org/2001/XMLSchema#integer">15</spin:rulePropertyMaxIterationCount>
            <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
            <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >Rules that are executed in second time</rdfs:label>
            <spin:nextRuleProperty>
              <spin:RuleProperty rdf:about="http://spinrdf.org/spin#rule_3Executed">
                <spin:rulePropertyMaxIterationCount rdf:datatype=
                "http://www.w3.org/2001/XMLSchema#integer">15</spin:rulePropertyMaxIterationCount>
                <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                >Rules that are executed last</rdfs:label>
                <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
                <spin:nextRuleProperty>
                  <spin:RuleProperty rdf:about="http://spinrdf.org/spin#rule_4Executed">
                    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
                    <spin:nextRuleProperty>
                      <spin:RuleProperty rdf:about="http://spinrdf.org/spin#lastFrameAdvance">
                        <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
                      </spin:RuleProperty>
                    </spin:nextRuleProperty>
                  </spin:RuleProperty>
                </spin:nextRuleProperty>
              </spin:RuleProperty>
            </spin:nextRuleProperty>
          </spin:RuleProperty>
        </spin:nextRuleProperty>
      </spin:RuleProperty>
    </spin:nextRuleProperty>
  </spin:RuleProperty>
  <spin:Function rdf:about="http://spinrdf.org/spin#mergeBlob">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >merges two blobs</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <spin:body>
      <sp:Construct>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >left1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bottom1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >right1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b1p2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >top1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >left2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bottom2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >right2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >b2p2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >top2</sp:varName>
            </sp:object>
          </rdf:Description>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >minLeft</sp:varName>
            </sp:variable>
            <sp:expression>
              <afn:min>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >left1</sp:varName>
                </sp:arg1>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >left2</sp:varName>
                </sp:arg2>
              </afn:min>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >maxRight</sp:varName>
            </sp:variable>
            <sp:expression>
              <afn:max>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >right1</sp:varName>
                </sp:arg1>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >right2</sp:varName>
                </sp:arg2>
              </afn:max>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >minTop</sp:varName>
            </sp:variable>
            <sp:expression>
              <afn:min>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >top1</sp:varName>
                </sp:arg1>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >top2</sp:varName>
                </sp:arg2>
              </afn:min>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >maxBottom</sp:varName>
            </sp:variable>
            <sp:expression>
              <afn:max>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >bottom1</sp:varName>
                </sp:arg1>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >bottom2</sp:varName>
                </sp:arg2>
              </afn:max>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >merge</sp:varName>
            </sp:variable>
            <sp:expression>
              <sp:uri>
                <sp:arg1>
                  <fn:concat>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >spThing1</sp:varName>
                    </sp:arg1>
                    <sp:arg2>_merge</sp:arg2>
                  </fn:concat>
                </sp:arg1>
              </sp:uri>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bbNew</sp:varName>
            </sp:variable>
            <sp:expression>
              <sp:uri>
                <sp:arg1>
                  <fn:concat>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >spThing1</sp:varName>
                    </sp:arg1>
                    <sp:arg2>_mergeBB</sp:arg2>
                  </fn:concat>
                </sp:arg1>
              </sp:uri>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p1New</sp:varName>
            </sp:variable>
            <sp:expression>
              <sp:uri>
                <sp:arg1>
                  <fn:concat>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >spThing1</sp:varName>
                    </sp:arg1>
                    <sp:arg2>_mergeBB_p1</sp:arg2>
                  </fn:concat>
                </sp:arg1>
              </sp:uri>
            </sp:expression>
          </sp:Bind>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p2New</sp:varName>
            </sp:variable>
            <sp:expression>
              <sp:uri>
                <sp:arg1>
                  <fn:concat>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >spThing1</sp:varName>
                    </sp:arg1>
                    <sp:arg2>_mergeBB_p2</sp:arg2>
                  </fn:concat>
                </sp:arg1>
              </sp:uri>
            </sp:expression>
          </sp:Bind>
        </sp:where>
        <sp:templates rdf:parseType="Collection">
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >merge</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >merge</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bbNew</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bbNew</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p1New</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bbNew</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p2New</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p1New</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >minLeft</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p1New</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >maxBottom</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p2New</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >maxRight</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >p2New</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >minTop</sp:varName>
            </sp:object>
          </rdf:Description>
        </sp:templates>
      </sp:Construct>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#overlap">
    <spin:body>
      <sp:Ask>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areax1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areay1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areax2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areay2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >w</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#width"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >h</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#height"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <sp:Bind>
            <sp:expression>
              <sp:if>
                <sp:arg3 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >areax1</sp:varName>
                </sp:arg3>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >x1</sp:varName>
                </sp:arg2>
                <sp:arg1>
                  <sp:gt>
                    <sp:arg2 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areax1</sp:varName>
                    </sp:arg2>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >x1</sp:varName>
                    </sp:arg1>
                  </sp:gt>
                </sp:arg1>
              </sp:if>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x1over</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:if>
                <sp:arg3 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >areax2</sp:varName>
                </sp:arg3>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >x2</sp:varName>
                </sp:arg2>
                <sp:arg1>
                  <sp:gt>
                    <sp:arg2 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areax2</sp:varName>
                    </sp:arg2>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >x2</sp:varName>
                    </sp:arg1>
                  </sp:gt>
                </sp:arg1>
              </sp:if>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x2over</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:if>
                <sp:arg3 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >areay1</sp:varName>
                </sp:arg3>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >y1</sp:varName>
                </sp:arg2>
                <sp:arg1>
                  <sp:gt>
                    <sp:arg2 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areay1</sp:varName>
                    </sp:arg2>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >y1</sp:varName>
                    </sp:arg1>
                  </sp:gt>
                </sp:arg1>
              </sp:if>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y1over</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:if>
                <sp:arg3 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >areay2</sp:varName>
                </sp:arg3>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >y2</sp:varName>
                </sp:arg2>
                <sp:arg1>
                  <sp:gt>
                    <sp:arg2 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areay2</sp:varName>
                    </sp:arg2>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >y2</sp:varName>
                    </sp:arg1>
                  </sp:gt>
                </sp:arg1>
              </sp:if>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y2over</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:sub>
                <sp:arg2>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >x2over</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg2>
                <sp:arg1>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >x1over</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg1>
              </sp:sub>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >overW</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:sub>
                <sp:arg2>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >y2over</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg2>
                <sp:arg1>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >y1over</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg1>
              </sp:sub>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >overH</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:mul>
                <sp:arg2>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >overH</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg2>
                <sp:arg1>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >overW</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg1>
              </sp:mul>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >overArea</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Bind>
            <sp:expression>
              <sp:mul>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >percent</sp:varName>
                </sp:arg2>
                <sp:arg1>
                  <sp:mul>
                    <sp:arg2>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >w</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg2>
                    <sp:arg1>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >w</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg1>
                  </sp:mul>
                </sp:arg1>
              </sp:mul>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >minArea</sp:varName>
            </sp:variable>
          </sp:Bind>
          <sp:Filter>
            <sp:expression>
              <sp:ge>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >minArea</sp:varName>
                </sp:arg2>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >overArea</sp:varName>
                </sp:arg1>
              </sp:ge>
            </sp:expression>
          </sp:Filter>
        </sp:where>
      </sp:Ask>
    </spin:body>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >A spatial thing contains another spatial thing</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#percent"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#belongToNextFrame">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >It is true if blob2 is in a frame next to blob1</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#blob1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#blob2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:body>
      <sp:Ask>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >frame1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#belongTo"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >blob1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >frame2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#belongTo"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >blob2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >blob1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#Blob"/>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >blob2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >frame2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasNext"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >frame1</sp:varName>
            </sp:subject>
          </rdf:Description>
        </sp:where>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#pointDistance">
    <spin:body>
      <sp:Select>
        <sp:resultVariables rdf:parseType="Collection">
          <rdf:Description>
            <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >dist</sp:varName>
          </rdf:Description>
        </sp:resultVariables>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <sp:Bind>
            <sp:expression>
              <afn:sqrt>
                <sp:arg1>
                  <sp:add>
                    <sp:arg2>
                      <sp:mul>
                        <sp:arg2>
                          <sp:sub>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y2</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                          </sp:sub>
                        </sp:arg2>
                        <sp:arg1>
                          <sp:sub>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y2</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >y1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                          </sp:sub>
                        </sp:arg1>
                      </sp:mul>
                    </sp:arg2>
                    <sp:arg1>
                      <sp:mul>
                        <sp:arg2>
                          <sp:sub>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x2</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                          </sp:sub>
                        </sp:arg2>
                        <sp:arg1>
                          <sp:sub>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x2</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                          </sp:sub>
                        </sp:arg1>
                      </sp:mul>
                    </sp:arg1>
                  </sp:add>
                </sp:arg1>
              </afn:sqrt>
            </sp:expression>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >dist</sp:varName>
            </sp:variable>
          </sp:Bind>
        </sp:where>
      </sp:Select>
    </spin:body>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing2"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >Second SpatialThing</rdfs:comment>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing1"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >First SpatialThing</rdfs:comment>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Distance between two points</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#calc_direction">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >/* &#xD;
arg5 is the minimal number of pixels for considering the movement.&#xD;
&#xD;
arg1=person.tracking:x;&#xD;
arg2=bb.tracking:x;&#xD;
arg3=person.tracking:y;&#xD;
arg4=bb.tracking:y; &#xD;
&#xD;
*/&#xD;
var new_dir = ""; &#xD;
var diffx = arg1 - arg3;&#xD;
var diffy = arg2 - arg4;&#xD;
&#xD;
if (Math.abs (diffx) &lt; arg5)  &#xD;
 if (Math.abs (diffy) &lt; arg5)&#xD;
  new_dir = "stop";&#xD;
 else&#xD;
  if (diffy &gt;= arg5) &#xD;
   new_dir = "nord";&#xD;
  else&#xD;
   new_dir = "south";&#xD;
else&#xD;
 if (Math.abs (diffy) &lt; arg5) &#xD;
  if (diffx &gt;= arg5)&#xD;
   new_dir = "west";&#xD;
  else&#xD;
   new_dir = "est";&#xD;
if (new_dir == "")&#xD;
 if (diffx &gt;= arg5)&#xD;
  if (diffy &gt;= arg5) &#xD;
   new_dir = "nwest";&#xD;
  else &#xD;
   new_dir = "swest";&#xD;
 else&#xD;
  if (diffy &gt;= arg5)&#xD;
   new_dir = "nest";&#xD;
  else&#xD;
   new_dir = "sest";&#xD;
return "tracking:"+ new_dir;&#xD;
&#xD;
function isSmallDiff(arg1, arg2, arg3) {&#xD;
 if (Math.abs(arg1-arg2) &lt; arg3) &#xD;
 return 1; &#xD;
else &#xD;
 return 0;&#xD;
}&#xD;
</spinx:javaScriptCode>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg5"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >calcolare la direzione</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#coordinateDistance">
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?dist
WHERE {
    BIND (afn:sqrt((((xsd:integer(?x1) - xsd:float(?x2)) * (xsd:integer(?x1) - xsd:float(?x2))) + ((xsd:integer(?y1) - xsd:float(?y2)) * (xsd:integer(?y1) - xsd:float(?y2))))) AS ?dist) .
}</sp:text>
      </sp:Select>
    </spin:body>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#y1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#x1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Distance between the coordinates of two points</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#x2"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#y2"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
      </spl:Argument>
    </spin:constraint>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#isGroupingProbable">
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Is Grouping Probable</rdfs:label>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >computes if grouping is probable</rdfs:comment>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#boolean"/>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    > /*&#xD;
    arg1= distance&#xD;
    arg2= direction score&#xD;
    arg3=speed1&#xD;
    arg4=speed2&#xD;
    */&#xD;
    var speed1 = arg3, speed2 = arg4, distance = arg1;&#xD;
    //case 1: direction score is very high - compatible directions&#xD;
    if (arg2 &gt;= 0.7)&#xD;
    { return true; }&#xD;
    //case 2: same direction - check speed&#xD;
    if (arg2 &gt;= 0.5) {&#xD;
        if (speed1 - speed2 &gt;= distance)&#xD;
        { return true; }&#xD;
        else&#xD;
        { return false; }&#xD;
    }&#xD;
    if (arg2 == 0)&#xD;
    { return false; }&#xD;
    //other cases momentarily ignored&#xD;
    return false;</spinx:javaScriptCode>
  </spin:Function>
  <spin:MagicProperty rdf:about="http://spinrdf.org/spin#mergeFrameBlobs">
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?mx1  ?my1 ?mx2 ?my2 
WHERE {
    {
        SELECT ((MIN(?tlx)) AS ?mx1) ((MIN(?tly)) AS ?my1) ((MAX(?brx)) AS ?mx2) ((MAX(?bry)) AS ?my2) ((COUNT(*)) AS ?numblobs)
        WHERE {
            ?spThing1 tracking:hasBoundingBox ?bb1 .
            ?spThing1 tracking:belongTo ?arg1 .
            ?bb1 tracking:topLeftVertex ?tl .
            ?bb1 tracking:bottomRightVertex ?br .
            ?br tracking:x ?brx .
            ?br tracking:y ?bry .
            ?tl tracking:x ?tlx .
            ?tl tracking:y ?tly .
            FILTER spin:closeToOccludingObject(?spThing1) .
        }
    } .&#xD;
FILTER(?numblobs&gt;1) .
}</sp:text>
      </sp:Select>
    </spin:body>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Merges blobs near an occluding object</rdfs:comment>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#MagicProperties"/>
  </spin:MagicProperty>
  <owl:NamedIndividual rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#Medium_Perspective"/>
  <spin:Function rdf:about="http://spinrdf.org/spin#getMinHumanDistance">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >person with minimum distance with spatialthing in input</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ((MIN(?dist)) AS ?mindist)
WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?spThing2 a tracking:Blob .
    ?bb1 tracking:bottomLeftVertex ?point1 .
    ?bb2 tracking:bottomLeftVertex ?point2 .&#xD;
?spThing1 tracking:belongTo ?frame1 .&#xD;
?spThing2 tracking:belongTo ?frame2 .&#xD;
?frame1 tracking:hasNext ?frame2 .
    BIND (spin:pointDistance(?point1, ?point2) AS ?dist) .
    FILTER (spin:hasHumanSize(?spThing2)) .&#xD;
FILTER NOT EXISTS&#xD;
{ &#xD;
?p tracking:blobMatch ?spThing2&#xD;
}
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#predictXPosition">
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >var x = arg1;&#xD;
var dir = arg2, speed = arg3;&#xD;
var time=arg4;&#xD;
var toRemove = "http://mivia.unisa.it/videotracking/tracking.owl#";&#xD;
var toRemove2 = "tracking:";&#xD;
dir = dir.replace(toRemove, "").replace(toRemove2, "");&#xD;
    var cosValues = [1, 0.70, 0, -0.70, 0.70, 0, 0, -0.70, -1];&#xD;
    &#xD;
    var cos = 0, sin = 0;&#xD;
    //assign values according to direction angle&#xD;
    switch (dir) {&#xD;
        case "est":&#xD;
            //0°&#xD;
            cos = cosValues[0];&#xD;
          &#xD;
            break;&#xD;
        case "nest":&#xD;
            //45°&#xD;
            cos = cosValues[1];&#xD;
        &#xD;
            break;&#xD;
        case "nord":&#xD;
            //90°&#xD;
            cos = cosValues[2];&#xD;
       &#xD;
            break;&#xD;
        case "nwest":&#xD;
            //135°&#xD;
            cos = cosValues[3];&#xD;
      &#xD;
            break;&#xD;
        case "sest":&#xD;
            //315&#xD;
            cos = cosValues[4];&#xD;
     &#xD;
            break;&#xD;
        case "south":&#xD;
            //270&#xD;
            cos = cosValues[5];&#xD;
     &#xD;
            break;&#xD;
        case "stop":&#xD;
            cos = cosValues[6];&#xD;
     &#xD;
            break;&#xD;
        case "swest":&#xD;
            //225&#xD;
            cos = cosValues[7];&#xD;
      &#xD;
            break;&#xD;
        case "west":&#xD;
            //180&#xD;
            cos = cosValues[8];&#xD;
       &#xD;
            break;&#xD;
&#xD;
        default:&#xD;
            break;&#xD;
&#xD;
    }&#xD;
    /*Formule da:&#xD;
    Benkhelifa, Imane, and Samira Moussaoui. &#xD;
    "Speed and direction prediction-based localization for mobile wireless sensor networks." &#xD;
    Communications, Computers and Applications (MIC-CCA), 2012 Mosharaka International Conference on. &#xD;
    IEEE, 2012.&#xD;
    */&#xD;
    //xnext=x+cos@ * speed * time&#xD;
    //ynext=y+sen@ * speed * time&#xD;
    var xnext = x + cos * speed * time;&#xD;
   &#xD;
&#xD;
    return xnext;</spinx:javaScriptCode>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >predicts the future position of an object</rdfs:comment>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <rdf:Description rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#blob_478_4">
    <tracking:width rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >31</tracking:width>
    <tracking:height rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >92</tracking:height>
  </rdf:Description>
  <tracking:SpatialPerspectiveArea rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#DefaultPerspectiveArea">
    <tracking:maxHumanWidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >59</tracking:maxHumanWidth>
    <tracking:minHumanHeight rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >39</tracking:minHumanHeight>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Perspective area with default values for human size</rdfs:label>
    <tracking:maxHumanHeight rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >111</tracking:maxHumanHeight>
    <tracking:minHumanWidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >13</tracking:minHumanWidth>
  </tracking:SpatialPerspectiveArea>
  <spin:Function rdf:about="http://spinrdf.org/spin#getBlobSpeed">
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing2"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Blob Speed</rdfs:label>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >computes speed by comparing two blobs</rdfs:comment>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?newSpeed
WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?spThing1 tracking:belongTo ?frame1 .
    ?frame1 tracking:id ?id1 .
    ?spThing2 tracking:belongTo ?frame2 .
    ?frame2 tracking:id ?id2 .
    ?bb1 tracking:bottomLeftVertex ?p1 .
    ?bb2 tracking:bottomLeftVertex ?p2 .
    ?p1 tracking:x ?x1 .
    ?p1 tracking:y ?y1 .
    ?p2 tracking:x ?x2 .
    ?p2 tracking:y ?y2 .
    BIND (spin:getAverageSpeed(?x1, ?y1, ?x2, ?y2, ?id1, ?id2) AS ?newSpeed) .
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#hasHumanSize">
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?spThing a tracking:Blob .
    ?spThing tracking:width ?w .
    ?spThing tracking:height ?h .
    OPTIONAL {
        ?spThing spin:hasPerspectiveArea ?area .
        ?area tracking:maxHumanWidth ?wMax .
        ?area tracking:maxHumanHeight ?hMax .
        ?area tracking:minHumanWidth ?wMin .
        ?area tracking:minHumanHeight ?hMin .
    } .
    OPTIONAL {
        tracking:DefaultPerspectiveArea tracking:maxHumanWidth ?wMax .
        tracking:DefaultPerspectiveArea tracking:maxHumanHeight ?hMax .
        tracking:DefaultPerspectiveArea tracking:minHumanWidth ?wMin .
        tracking:DefaultPerspectiveArea tracking:minHumanHeight ?hMin .
    } .
    FILTER ((((?w &lt;= ?wMax) &amp;&amp; ( ?h &lt;= ?hMax)) &amp;&amp; (?w &gt;= ?wMin)) &amp;&amp; (?h &gt;= ?hMin)) .
}</sp:text>
      </sp:Ask>
    </spin:body>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >A SpatialThing has group size when it is both wider and higher than an human</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#isInPerspectiveArea">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >return if element has perspective area</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#area"/>
      </spl:Argument>
    </spin:constraint>
    <spin:body>
      <sp:Ask>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:object rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#SpatialPerspectiveArea"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >area</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >area</sp:varName>
            </sp:subject>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomLeftVertex"/>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topRightVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >x1</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >y1</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb1point1</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areax1</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
          </rdf:Description>
          <rdf:Description>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:subject>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areay1</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areax2</sp:varName>
            </sp:object>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:subject>
          </rdf:Description>
          <rdf:Description>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >areay2</sp:varName>
            </sp:object>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
          </rdf:Description>
          <sp:Filter>
            <sp:expression>
              <sp:and>
                <sp:arg2>
                  <sp:ge>
                    <sp:arg2>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >areay2</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg2>
                    <sp:arg1>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >y1</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg1>
                  </sp:ge>
                </sp:arg2>
                <sp:arg1>
                  <sp:and>
                    <sp:arg1>
                      <sp:and>
                        <sp:arg2>
                          <sp:le>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >areax2</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                          </sp:le>
                        </sp:arg2>
                        <sp:arg1>
                          <sp:ge>
                            <sp:arg1>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >x1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg1>
                            <sp:arg2>
                              <xsd:integer>
                                <sp:arg1 rdf:parseType="Resource">
                                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                                  >areax1</sp:varName>
                                </sp:arg1>
                              </xsd:integer>
                            </sp:arg2>
                          </sp:ge>
                        </sp:arg1>
                      </sp:and>
                    </sp:arg1>
                    <sp:arg2>
                      <sp:le>
                        <sp:arg1>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >y1</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg1>
                        <sp:arg2>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >areay1</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg2>
                      </sp:le>
                    </sp:arg2>
                  </sp:and>
                </sp:arg1>
              </sp:and>
            </sp:expression>
          </sp:Filter>
        </sp:where>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#near">
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?bb1 tracking:bottomLeftVertex ?point1 .
    ?bb2 tracking:bottomLeftVertex ?point2 .
    BIND ( spin:pointDistance(?point1, ?point2) AS ?dist) .
    FILTER (?dist &lt; 20) .
}</sp:text>
      </sp:Ask>
    </spin:body>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >computes when object is near another object</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#getMinTrackedInstance">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Get min distance between people or groups</rdfs:comment>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >get Min Tracked Distance</rdfs:label>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ((MIN(?dist)) AS ?mindist)&#xD;
WHERE {&#xD;
    ?spThing1 tracking:hasBoundingBox ?bb1 .&#xD;
    ?spThing2 tracking:hasBoundingBox ?bb2 .&#xD;
    ?spThing2 a tracking:Blob .&#xD;
?spThing1 tracking:belongTo ?frame1 .&#xD;
?spThing2 tracking:belongTo ?frame2 .&#xD;
?frame1 tracking:hasNext ?frame2 .&#xD;
    ?bb1 tracking:bottomLeftVertex ?point1 .&#xD;
    ?bb2 tracking:bottomLeftVertex ?point2 .&#xD;
    BIND (spin:pointDistance(?point1, ?point2) AS ?dist) .&#xD;
    FILTER (( spin:hasHumanSize(?spThing2)||spin:hasGroupSize(?spThing2))) .&#xD;
FILTER NOT EXISTS&#xD;
{ ?p tracking:blobMatch ?spThing2&#xD;
}&#xD;
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#checkBoxIntersection">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg7"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg5"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >width first box w1</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >if ((Math.abs(arg1 - arg3) * 2 &lt; (arg5 + arg7)) &amp;&amp;&#xD;
         (Math.abs(arg2 - arg4) * 2 &lt; (arg6 + arg8)))&#xD;
	return true;&#xD;
else&#xD;
	return false;</spinx:javaScriptCode>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#boolean"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >height first box (h1)</rdfs:comment>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg6"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of first object (x1)</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >x coordinate of second box (x2)</rdfs:comment>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg8"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of second box (y2)</rdfs:comment>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >y coordinate of first box (y1)</rdfs:comment>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
      </spl:Argument>
    </spin:constraint>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#area">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >area of blob</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
      </spl:Argument>
    </spin:constraint>
    <spin:body>
      <sp:Select>
        <sp:where rdf:parseType="Collection">
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#width"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >w</sp:varName>
            </sp:object>
          </rdf:Description>
          <rdf:Description>
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >spThing</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#height"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >h</sp:varName>
            </sp:object>
          </rdf:Description>
          <sp:Bind>
            <sp:variable rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >area</sp:varName>
            </sp:variable>
            <sp:expression>
              <sp:mul>
                <sp:arg1 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >w</sp:varName>
                </sp:arg1>
                <sp:arg2 rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >h</sp:varName>
                </sp:arg2>
              </sp:mul>
            </sp:expression>
          </sp:Bind>
        </sp:where>
        <sp:resultVariables rdf:parseType="Collection">
          <rdf:Description>
            <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >area</sp:varName>
          </rdf:Description>
        </sp:resultVariables>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:ID="isSmallDiff">
    <spinx:javaScriptFile rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >isSmallDiff.js</spinx:javaScriptFile>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >says if a person can be part of group</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <rdf:Description rdf:about="http://xmlns.com/foaf/0.1/Agent">
    <spin:rule_3Executed>
      <sp:Modify>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >#detects agents that left the scene&#xD;
INSERT {
   ?this tracking:hasSituation tracking:LeavingScene
}
WHERE {&#xD;
#agents with no match in current frame&#xD;
    ?this tracking:hasBoundingBox ?bb .&#xD;
 ?blob tracking:hasBoundingBox ?bb .&#xD;
   ?blob tracking:belongTo ?frame.&#xD;
?frame tracking:id ?id.&#xD;
?frame tracking:hasNext ?nextF .&#xD;
?nextF tracking:id ?nextID.&#xD;
#checks if agents are near an entry/exit scene&#xD;
 tracking:CurrentFrame tracking:id ?nextID.&#xD;
 ?area a tracking:EntryArea .  &#xD;
 FILTER ( spin:feetInArea(?area, ?this)) .  &#xD;
#agents in groups don't count&#xD;
 FILTER NOT EXISTS {&#xD;
  ?this tracking:hasSituation tracking:JoinAGroup .&#xD;
    } .&#xD;
}</sp:text>
      </sp:Modify>
    </spin:rule_3Executed>
  </rdf:Description>
  <owl:NamedIndividual rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#Small_Perspective"/>
  <spin:Function rdf:about="http://spinrdf.org/spin#getDirectionScore">
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg5"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Get Direction Score</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg6"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >/*&#xD;
arg1=obj1.x&#xD;
arg2=obj1.y&#xD;
arg3=obj2.x&#xD;
arg4=obj2.y&#xD;
arg5=obj1 dir&#xD;
arg6=obj2 dir&#xD;
*/&#xD;
&#xD;
    //object to the left&#xD;
    var obj1dir = "";&#xD;
    //object to the right&#xD;
    var obj2dir = "";&#xD;
    //is obj1 the one at the bottom?&#xD;
    var isObj1bottom = false;&#xD;
var toRemove = "http://mivia.unisa.it/videotracking/tracking.owl#";&#xD;
    var toRemove2 = "tracking:";&#xD;
    if (arg1 &lt; arg3) {&#xD;
        //first object is obj1&#xD;
        obj1dir = arg5.replace(toRemove, "").replace(toRemove2, "");&#xD;
        obj2dir = arg6.replace(toRemove, "").replace(toRemove2, "");&#xD;
        if (arg2 &gt; arg4)&#xD;
        { isObj1bottom = true; }&#xD;
&#xD;
    }&#xD;
    else {&#xD;
        obj1dir = arg6.replace(toRemove, "").replace(toRemove2, "");&#xD;
        obj2dir = arg5.replace(toRemove, "").replace(toRemove2, "");&#xD;
        if (arg2 &lt;= arg4)&#xD;
        { isObj1bottom = true; }&#xD;
    }&#xD;
    //array directionTable[obj2dir][obj1dir]&#xD;
    var directionTableBottom = [];&#xD;
    directionTableBottom["est"] = [0.5, 0.5, 0, 0, 0.2, 0, 0, 0, 0];&#xD;
    directionTableBottom["nest"] = [0.2, 0.5, 0, 0, 0, 0, 0, 0, 0];&#xD;
    directionTableBottom["nord"] = [0, 0.5, 0.2, 0, 0, 0, 0, 0, 0];&#xD;
    directionTableBottom["nwest"] = [0.5, 0.7, 0.5, 0.2, 0.2, 0, 0.2, 0.2, 0.2];&#xD;
    directionTableBottom["sest"] = [0.7, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2];&#xD;
    directionTableBottom["south"] = [1, 0.7, 1, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5];&#xD;
    directionTableBottom["stop"] = [0.5, 0.7, 0.5, 0, 0.2, 0, 0, 0, 0];&#xD;
    directionTableBottom["swest"] = [0.7, 1, 0.7, 0.5, 0.5, 0.7, 0.7, 0.5, 0.5];&#xD;
    directionTableBottom["west"] = [1, 1, 0.7, 0.2, 0.5, 0.5, 0.5, 0.2, 0.5];&#xD;
&#xD;
    var directionTableTop = [];&#xD;
    directionTableTop["est"] = [0.5, 0.2, 0, 0, 0.5, 0.2, 0, 0, 0];&#xD;
    directionTableTop["nest"] = [0.7, 0.5, 0.2, 0.2, 0.7, 0.5, 0.2, 0.5, 0.2];&#xD;
    directionTableTop["nord"] = [1, 0.7, 0.5, 0.2, 1, 1, 0.5, 0.5, 0.5];&#xD;
    directionTableTop["nwest"] = [1, 1, 0.7, 0.5, 1, 1, 1, 0.7, 0.7];&#xD;
    directionTableTop["sest"] = [0.2, 0.2, 0.0, 0, 0.5, 0.2, 0, 0, 0.2];&#xD;
    directionTableTop["south"] = [0, 0.2, 0, 0, 0.5, 0.5, 0, 0, 0.5];&#xD;
    directionTableTop["stop"] = [0.5, 0.2, 0, 0, 0.7, 0.5, 0, 0.2, 0];&#xD;
    directionTableTop["swest"] = [0.5, 0.2, 0.2, 0.2, 0.7, 0.7, 0.2, 0.5, 0.5];&#xD;
    directionTableTop["west"] = [1, 0.5, 0.5, 0.2, 1, 1, 0.5, 0.7, 0.5];&#xD;
    var directionTable = [];&#xD;
    if (isObj1bottom)&#xD;
    { directionTable = directionTableBottom; }&#xD;
    else&#xD;
    { directionTable = directionTableTop; }&#xD;
&#xD;
    switch (obj1dir) {&#xD;
        case "est":&#xD;
            return directionTable[obj2dir][0];&#xD;
        case "nest":&#xD;
            return directionTable[obj2dir][1];&#xD;
        case "nord":&#xD;
            return directionTable[obj2dir][2];&#xD;
        case "nwest":&#xD;
            return directionTable[obj2dir][3];&#xD;
        case "sest":&#xD;
            return directionTable[obj2dir][4];&#xD;
        case "south":&#xD;
            return directionTable[obj2dir][5];&#xD;
        case "stop":&#xD;
            return directionTable[obj2dir][6];&#xD;
        case "swest":&#xD;
            return directionTable[obj2dir][7];&#xD;
        case "west":&#xD;
            return directionTable[obj2dir][8];&#xD;
&#xD;
        default:&#xD;
            return -1;&#xD;
&#xD;
    }&#xD;
</spinx:javaScriptCode>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Assigns score to objects according to their directions</rdfs:comment>
  </spin:Function>
  <spin:Function rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#getNewDirection">
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >gets new direction of tracked object</rdfs:label>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?newdir
WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?bb1 tracking:bottomLeftVertex ?p1 .
    ?bb2 tracking:bottomLeftVertex ?p2 .
    ?p1 tracking:x ?x1 .
    ?p1 tracking:y ?y1 .
    ?p2 tracking:x ?x2 .
    ?p2 tracking:y ?y2 .
    BIND (URI( tracking:calc_direction(?x1, ?y1, ?x2, ?y2, 5)) AS ?newdir) .
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#feetInArea">
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?bb1 tracking:topLeftVertex ?bb1point1 .
    ?bb2 tracking:topLeftVertex ?bb2point1 .
    ?bb1 tracking:bottomRightVertex ?bb1point2 .
    ?bb2 tracking:bottomRightVertex ?bb2point2 .
    ?bb1point1 tracking:x ?areax1 .
    ?bb1point1 tracking:y ?areay1 .
    ?bb1point2 tracking:x ?areax2 .
    ?bb1point2 tracking:y ?areay2 .
    ?bb2point1 tracking:x ?x1 .
    ?bb2point1 tracking:y ?y1 .
    ?bb2point2 tracking:x ?x2 .
    ?bb2point2 tracking:y ?y2 .
    FILTER ((((xsd:integer(?x1) &gt;= xsd:integer(?areax1)) &amp;&amp; (xsd:integer(?x2) &lt;= xsd:integer(?areax2))) &amp;&amp; (xsd:integer(?y2) &gt;= xsd:integer(?areay1))) &amp;&amp; (xsd:integer(?y2) &lt;= xsd:integer(?areay2))) .
}</sp:text>
      </sp:Ask>
    </spin:body>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >checks if a blob has the lower part in an area</rdfs:label>
  </spin:Function>
  <spin:MagicProperty rdf:about="http://spinrdf.org/spin#hasPerspectiveArea">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#MagicProperties"/>
    <spin:returnType rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#SpatialPerspectiveArea"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >function that associates spatialthing with the perspectivearea in which it is contained</rdfs:label>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?area
WHERE {
    {
        ?arg1 tracking:hasBoundingBox ?bb1 .
        ?area a tracking:SpatialPerspectiveArea .
        FILTER spin:isInPerspectiveArea(?area, ?arg1) .
    } .
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:MagicProperty>
  <spin:Function rdf:about="http://spinrdf.org/spin#predictYPosition">
    <spinx:javaScriptCode rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >var y = arg1&#xD;
var dir = arg2, speed = arg3;&#xD;
var time=arg4;&#xD;
var toRemove = "http://mivia.unisa.it/videotracking/tracking.owl#";&#xD;
var toRemove2 = "tracking:";&#xD;
dir = dir.replace(toRemove, "").replace(toRemove2, "");&#xD;
 &#xD;
    var sinValues = [0, 0.70, 1, 0.70, -0.70, -1, 0, -0.70, 0];&#xD;
    var cos = 0, sin = 0;&#xD;
    //assign values according to direction angle&#xD;
    switch (dir) {&#xD;
        case "est":&#xD;
            //0°&#xD;
        &#xD;
            sin = sinValues[0];&#xD;
            break;&#xD;
        case "nest":&#xD;
            //45°&#xD;
         &#xD;
            sin = sinValues[1];&#xD;
            break;&#xD;
        case "nord":&#xD;
            //90°&#xD;
         &#xD;
            sin = sinValues[2];&#xD;
            break;&#xD;
        case "nwest":&#xD;
            //135°&#xD;
       &#xD;
            sin = sinValues[3];&#xD;
            break;&#xD;
        case "sest":&#xD;
            //315&#xD;
         &#xD;
            sin = sinValues[4];&#xD;
            break;&#xD;
        case "south":&#xD;
            //270&#xD;
       &#xD;
            sin = sinValues[5];&#xD;
            break;&#xD;
        case "stop":&#xD;
         &#xD;
            sin = sinValues[6];&#xD;
            break;&#xD;
        case "swest":&#xD;
            //225&#xD;
     &#xD;
            sin = sinValues[7];&#xD;
            break;&#xD;
        case "west":&#xD;
            //180&#xD;
      &#xD;
            sin = sinValues[8];&#xD;
            break;&#xD;
&#xD;
        default:&#xD;
            break;&#xD;
&#xD;
    }&#xD;
    /*Formule da:&#xD;
    Benkhelifa, Imane, and Samira Moussaoui. &#xD;
    "Speed and direction prediction-based localization for mobile wireless sensor networks." &#xD;
    Communications, Computers and Applications (MIC-CCA), 2012 Mosharaka International Conference on. &#xD;
    IEEE, 2012.&#xD;
    */&#xD;
    //xnext=x+cos@ * speed * time&#xD;
    //ynext=y+sen@ * speed * time&#xD;
   &#xD;
    //negative because the higher the y the lower the point&#xD;
    var ynext = y - sin * speed * time;&#xD;
&#xD;
    return ynext;</spinx:javaScriptCode>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg4"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg3"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg2"/>
      </spl:Argument>
    </spin:constraint>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >predicts the future position of an object</rdfs:comment>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#closeToOccludingObject">
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#ablob"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >asks if a boundingbox is close to an occlusion area</rdfs:label>
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?ablob tracking:hasBoundingBox ?bb1 .
    ?Oarea a tracking:OccludingObject .
    ?Oarea tracking:hasBoundingBox ?bbOarea .
    ?bb1 tracking:topLeftVertex ?tl .
    ?bb1 tracking:bottomRightVertex ?br .
    ?br tracking:x ?brx .
    ?br tracking:y ?bry .
    ?tl tracking:x ?tlx .
    ?tl tracking:y ?tly .
    ?bbOarea tracking:topLeftVertex ?bbOareaTL .
    ?bbOarea tracking:bottomRightVertex ?bbOareaBR .
    ?bbOareaTL tracking:x ?bbOareaTLx .
    ?bbOareaTL tracking:y ?bbOareaTLy .
    ?bbOareaBR tracking:x ?bbOareaBRx .
    ?bbOareaBR tracking:y ?bbOareaBRy .
    FILTER spin:checkBoxClosenessToAO( ?tlx, ?tly, ?brx, ?bry, ?bbOareaTLx, ?bbOareaTLy, ?bbOareaBRx, ?bbOareaBRy, 4) .
}</sp:text>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:RuleProperty rdf:about="http://spinrdf.org/spin#sceneAnalysisRule">
    <spin:rulePropertyMaxIterationCount rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
    >1</spin:rulePropertyMaxIterationCount>
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >infers new data by analyzing the scene</rdfs:comment>
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/spin#rule"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Scene Analysis Rule </rdfs:label>
    <spin:nextRuleProperty rdf:resource="http://spinrdf.org/spin#rule_1Executed"/>
  </spin:RuleProperty>
  <spin:Function rdf:about="http://spinrdf.org/spin#hasGroupSize">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#spThing"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >A SpatialThing has group size when it is both wider and higher than an human</rdfs:label>
    <spin:body>
      <sp:Ask>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >ASK WHERE {
    ?spThing a tracking:Blob .
    ?spThing tracking:width ?w .
    ?spThing tracking:height ?h .
    OPTIONAL {
        ?spThing spin:hasPerspectiveArea ?area .
        ?area tracking:maxHumanWidth ?wMax .
        ?area tracking:maxHumanHeight ?hMax .
        ?area tracking:minHumanHeight ?hMin .&#xD;
?area tracking:minHumanWidth ?wMin .
    } .
    OPTIONAL {
        tracking:DefaultPerspectiveArea tracking:maxHumanWidth ?wMax .
        tracking:DefaultPerspectiveArea tracking:maxHumanHeight ?hMax .
        tracking:DefaultPerspectiveArea tracking:minHumanHeight ?hMin .&#xD;
tracking:DefaultPerspectiveArea tracking:minHumanWidth ?wMin .
    } .
    FILTER (((?w &gt; ?wMax) &amp;&amp; (?h &gt; ?hMin)) || ((?w &gt; ?wMin) &amp;&amp; (?h &gt; ?hMax))) .
}</sp:text>
      </sp:Ask>
    </spin:body>
  </spin:Function>
  <spin:Function rdf:about="http://spinrdf.org/spin#blobsIn_OArea">
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?blob
WHERE {
    ?blob tracking:belongTo ?frame .
    ?area a tracking:OArea .
    ?area tracking:hasBoundingBox ?bbOArea .
    FILTER spin:intersect( ?area, ?blob) .
}</sp:text>
      </sp:Select>
    </spin:body>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/arg#frame"/>
      </spl:Argument>
    </spin:constraint>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >all the blobs in occlusion area</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
  </spin:Function>
  <spin:MagicProperty rdf:about="http://spinrdf.org/spin#isStillTracked">
    <rdfs:comment rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >returns true if a resource is not out of the scene ; if resource is out it does not return any value</rdfs:comment>
    <spin:constraint>
      <spl:Argument>
        <spl:valueType rdf:resource="http://www.w3.org/2000/01/rdf-schema#Resource"/>
        <spl:predicate rdf:resource="http://spinrdf.org/sp#arg1"/>
      </spl:Argument>
    </spin:constraint>
    <spin:returnType rdf:resource="http://www.w3.org/2001/XMLSchema#boolean"/>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?x&#xD;
WHERE{&#xD;
?arg1 tracking:hasBoundingBox ?bb.&#xD;
BIND(true as ?x).&#xD;
FILTER NOT EXISTS&#xD;
{&#xD;
?arg1 tracking:hasSituation tracking:LeavingScene&#xD;
}&#xD;
}</sp:text>
      </sp:Select>
    </spin:body>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#MagicProperties"/>
  </spin:MagicProperty>
  <spin:Function rdf:about="http://mivia.unisa.it/videotracking/tracking.owl#blobDistance">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >distance between two blobs</rdfs:label>
    <spin:body>
      <sp:Select>
        <sp:text rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >SELECT ?dist
WHERE {
    ?spThing1 tracking:hasBoundingBox ?bb1 .
    ?spThing2 tracking:hasBoundingBox ?bb2 .
    ?bb1 tracking:bottomLeftVertex ?point1 .
    ?bb2 tracking:bottomLeftVertex ?point2 .
    BIND (spin:pointDistance(?point1, ?point2) AS ?dist) .
}</sp:text>
      </sp:Select>
    </spin:body>
  </spin:Function>
  <rdf:Description rdf:nodeID="A0">
    <rdf:first rdf:parseType="Resource">
      <sp:subject rdf:parseType="Resource">
        <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >bb1point2</sp:varName>
      </sp:subject>
      <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
      <sp:object rdf:parseType="Resource">
        <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >areax2</sp:varName>
      </sp:object>
    </rdf:first>
    <rdf:rest rdf:parseType="Collection">
      <rdf:Description>
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb1point2</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >areay2</sp:varName>
        </sp:object>
      </rdf:Description>
      <rdf:Description>
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb2point1</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >x1</sp:varName>
        </sp:object>
      </rdf:Description>
      <rdf:Description>
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb2point1</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >y1</sp:varName>
        </sp:object>
      </rdf:Description>
      <rdf:Description>
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb2point2</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >x2</sp:varName>
        </sp:object>
      </rdf:Description>
      <rdf:Description>
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb2point2</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >y2</sp:varName>
        </sp:object>
      </rdf:Description>
      <sp:Filter>
        <sp:expression>
          <sp:and>
            <sp:arg1>
              <sp:and>
                <sp:arg1>
                  <sp:and>
                    <sp:arg1>
                      <sp:ge>
                        <sp:arg1>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >x1</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg1>
                        <sp:arg2>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >areax1</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg2>
                      </sp:ge>
                    </sp:arg1>
                    <sp:arg2>
                      <sp:le>
                        <sp:arg1>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >x2</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg1>
                        <sp:arg2>
                          <xsd:integer>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                              >areax2</sp:varName>
                            </sp:arg1>
                          </xsd:integer>
                        </sp:arg2>
                      </sp:le>
                    </sp:arg2>
                  </sp:and>
                </sp:arg1>
                <sp:arg2>
                  <sp:ge>
                    <sp:arg1>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >y1</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg1>
                    <sp:arg2>
                      <xsd:integer>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                          >areay1</sp:varName>
                        </sp:arg1>
                      </xsd:integer>
                    </sp:arg2>
                  </sp:ge>
                </sp:arg2>
              </sp:and>
            </sp:arg1>
            <sp:arg2>
              <sp:le>
                <sp:arg1>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >y2</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg1>
                <sp:arg2>
                  <xsd:integer>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areay2</sp:varName>
                    </sp:arg1>
                  </xsd:integer>
                </sp:arg2>
              </sp:le>
            </sp:arg2>
          </sp:and>
        </sp:expression>
      </sp:Filter>
    </rdf:rest>
  </rdf:Description>
  <rdf:Description rdf:nodeID="A1">
    <rdf:rest rdf:parseType="Resource">
      <rdf:rest rdf:parseType="Resource">
        <rdf:rest rdf:parseType="Resource">
          <rdf:first rdf:parseType="Resource">
            <sp:subject rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2</sp:varName>
            </sp:subject>
            <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topLeftVertex"/>
            <sp:object rdf:parseType="Resource">
              <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
              >bb2point1</sp:varName>
            </sp:object>
          </rdf:first>
          <rdf:rest rdf:parseType="Resource">
            <rdf:first rdf:parseType="Resource">
              <sp:subject rdf:parseType="Resource">
                <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                >bb1</sp:varName>
              </sp:subject>
              <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomRightVertex"/>
              <sp:object rdf:parseType="Resource">
                <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                >bb1point2</sp:varName>
              </sp:object>
            </rdf:first>
            <rdf:rest rdf:parseType="Resource">
              <rdf:rest rdf:parseType="Resource">
                <rdf:rest rdf:parseType="Resource">
                  <rdf:rest rdf:nodeID="A0"/>
                  <rdf:first rdf:parseType="Resource">
                    <sp:subject rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >bb1point1</sp:varName>
                    </sp:subject>
                    <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#y"/>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                      >areay1</sp:varName>
                    </sp:object>
                  </rdf:first>
                </rdf:rest>
                <rdf:first rdf:parseType="Resource">
                  <sp:subject rdf:parseType="Resource">
                    <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                    >bb1point1</sp:varName>
                  </sp:subject>
                  <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#x"/>
                  <sp:object rdf:parseType="Resource">
                    <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                    >areax1</sp:varName>
                  </sp:object>
                </rdf:first>
              </rdf:rest>
              <rdf:first rdf:parseType="Resource">
                <sp:subject rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >bb2</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#bottomRightVertex"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
                  >bb2point2</sp:varName>
                </sp:object>
              </rdf:first>
            </rdf:rest>
          </rdf:rest>
        </rdf:rest>
        <rdf:first rdf:parseType="Resource">
          <sp:subject rdf:parseType="Resource">
            <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >bb1</sp:varName>
          </sp:subject>
          <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#topLeftVertex"/>
          <sp:object rdf:parseType="Resource">
            <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >bb1point1</sp:varName>
          </sp:object>
        </rdf:first>
      </rdf:rest>
      <rdf:first rdf:parseType="Resource">
        <sp:subject rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >spThing2</sp:varName>
        </sp:subject>
        <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
        <sp:object rdf:parseType="Resource">
          <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
          >bb2</sp:varName>
        </sp:object>
      </rdf:first>
    </rdf:rest>
    <rdf:first rdf:parseType="Resource">
      <sp:subject rdf:parseType="Resource">
        <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >spThing1</sp:varName>
      </sp:subject>
      <sp:predicate rdf:resource="http://mivia.unisa.it/videotracking/tracking.owl#hasBoundingBox"/>
      <sp:object rdf:parseType="Resource">
        <sp:varName rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
        >bb1</sp:varName>
      </sp:object>
    </rdf:first>
  </rdf:Description>
  <spin:Function rdf:about="http://spinrdf.org/spin#contains">
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#Functions"/>
    <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >A spatial thing contains another spatial thing</rdfs:label>
    <rdfs:subClassOf rdf:resource="http://spinrdf.org/spin#ResourceComparison"/>
    <spin:body>
      <sp:Ask>
        <sp:where rdf:nodeID="A1"/>
      </sp:Ask>
    </spin:body>
  </spin:Function>
</rdf:RDF>

<!-- Created with TopBraid -->
